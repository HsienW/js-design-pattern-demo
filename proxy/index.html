<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>Proxy</title>
</head>
<body>
<script>
    // Base
    function Sender() {
        this.senderState = false;
        this.send = function (proxy) {
            this.senderState = true;
            proxy.start();
            console.log('A: 幫我寄出貨物');
        };
        this.check = function (proxy) {
            console.log('A check: 請問貨物到了嗎?');
            console.log(proxy.checkPackageState());
        }
    }

    function Receiver() {
        this.receiveState = false;
        this.receiveDone = function () {
            this.receiveState = true;
            console.log('B: 收到貨物了');
        };
        this.check = function (proxy) {
            console.log('B check: 請問貨物到了嗎?');
            console.log(proxy.checkPackageState());
        }
    }

    function Express() {
        this.packageOngoing = false;
        this.checkPackageState = function () {
            return this.packageOngoing ? 'Express: 貨物運送中' : 'Express: 已送達';
        };
        this.start = function () {
            this.packageOngoing = true;
        };
        this.done = function (receiver) {
            this.packageOngoing = false;
            receiver.receiveDone();
        };
        // this.start = () => {
        //     console.log('我是' + name + '快遞');
        //     console.log(this.sender.name + '你好' + '請寫送貨單');
        //     console.log('代收貨物完, 準備寄送');
        // };
        // this.going = () => {
        //     console.log('我是' + name + '快遞' + '貨物運送中');
        // };
        // this.arrive = () => {
        //     console.log('我是' + name + '快遞');
        //     console.log(this.receiver.name + '你好' + '請寫收貨單');
        //     console.log('代收貨物送完');
        // };
        // this.done = () => {
        //     console.log('我是' + name + '快遞' + '貨物運送完成');
        // }
    }

    const personA = new Sender();
    const personB = new Receiver();
    const pandaExpress = new Express();

    personA.send(pandaExpress);

    setTimeout(() => {
        console.log('==========================');
        personA.check(pandaExpress);
    }, 2000);

    setTimeout(() => {
        console.log('==========================');
        personB.check(pandaExpress);
    }, 4000);

    setTimeout(() => {
        console.log('==========================');
        pandaExpress.done(personB);
    }, 6000);

    setTimeout(() => {
        console.log('==========================');
        personA.check(pandaExpress);
    }, 8000);
    //
    // // Start send package
    // personA.send();
    // pandaExpress.start();


    // // 保護代理 - CRUD system case
    // function User(account, auth) {
    //     this.account = account;
    //     this.auth = auth;
    // }
    //
    // function System(user) {
    //     this.user = user;
    // }
    //
    // User.prototype = {
    //     getAccount: function () {
    //         return this.account;
    //     },
    //     getAuth: function () {
    //         return this.auth;
    //     },
    //     create: function () {
    //         console.log("創建 item");
    //     },
    //     read: function () {
    //         console.log("查看 item");
    //     },
    //     update: function () {
    //         console.log("更新 item 內容");
    //     },
    //     delete: function () {
    //         console.log("刪除 item");
    //     }
    // };
    //
    // System.prototype = {
    //     getUser: function () {
    //         return this.user;
    //     },
    //     create: function () {
    //         if (this.user.getAuth() === "member" || this.user.getAuth() === "author") {
    //             return this.user.create();
    //         }
    //         console.log("請登入系統");
    //     },
    //     read: function () {
    //         if (this.user.getAuth() === "member" || this.user.getAuth() === "author") {
    //             return this.user.read();
    //         }
    //         console.log("請登入系統");
    //     },
    //     update: function () {
    //         if (this.user.getAuth() === "author") {
    //             return this.user.update();
    //         }
    //         console.log("沒有權限編輯與更新");
    //     },
    //     delete: function () {
    //         if (this.user.getAuth() === "author") {
    //             return this.user.delete();
    //         }
    //         console.log("沒有權限刪除");
    //     }
    // };
    //
    // const userA = new User('123', 'member');
    // const userB = new User('456', 'author');
    // new System(userA).update();
    // new System(userB).update();

</script>
</body>
</html>
